# E2Eテストケース一覧

## テスト環境

- **起動方法**: `make up`
- **フロントエンドURL**: http://localhost:5174
- **テストツール**: Playwright MCP
- **テスト用パスワード**: `Test123!`
- **テスト用アカウント**:
  - 一般ユーザー: `testuser@example.com` / `Test123!`
  - 管理者: `admin@example.com` / `Test123!`

## テストカテゴリ一覧

| カテゴリ | ID接頭辞 | 対象画面 | テストケース数 |
|---------|---------|---------|--------------|
| 認証 | AUTH | S001 (ログイン) | 3 |
| チャット | CHAT | S002 (チャット) | 4 |
| 設定 | SETTINGS | S003 (設定) | 4 |
| ユーザー管理 | ADMIN-USER | S004 (ユーザー管理) | 3 |
| ダッシュボード | ADMIN-DASH | S005 (ダッシュボード) | 2 |
| 会話履歴 | ADMIN-CONV | S006 (会話履歴) | 2 |

---

## AUTH: 認証

### AUTH-001: ログイン成功

- **画面**: /login
- **前提条件**: 未ログイン状態、テストユーザーが存在する
- **操作手順**:
  1. /login にアクセス
  2. メールアドレスを入力
  3. パスワードを入力
  4. ログインボタンをクリック
- **期待結果**: チャット画面（/chat）にリダイレクトされる

### AUTH-002: ログイン失敗（不正な認証情報）

- **画面**: /login
- **前提条件**: 未ログイン状態
- **操作手順**:
  1. /login にアクセス
  2. 存在しないメールアドレスを入力
  3. パスワードを入力
  4. ログインボタンをクリック
- **期待結果**: エラーメッセージが表示され、ログイン画面に留まる

### AUTH-003: ログアウト

- **画面**: 任意の認証済み画面
- **前提条件**: ログイン済み
- **操作手順**:
  1. ナビゲーションバーのユーザーメニューを開く
  2. ログアウトをクリック
- **期待結果**: ログイン画面（/login）にリダイレクトされる

---

## CHAT: チャット

### CHAT-001: 新規会話の作成

- **画面**: /chat
- **前提条件**: ログイン済み
- **操作手順**:
  1. /chat にアクセス
  2. メッセージ入力欄にテキストを入力
  3. 送信ボタンをクリック（またはEnterキー）
- **期待結果**: メッセージが送信され、AIからのストリーミングレスポンスが表示される。URLが /chat/{uuid} に変わる

### CHAT-002: 既存会話でのメッセージ送信

- **画面**: /chat/:uuid
- **前提条件**: ログイン済み、既存の会話が存在する
- **操作手順**:
  1. サイドバーから既存の会話を選択
  2. メッセージ入力欄にテキストを入力
  3. 送信ボタンをクリック
- **期待結果**: 過去のメッセージが表示された状態で、新しいメッセージとAIレスポンスが追加される

### CHAT-003: 会話の削除

> **Note**: バックエンドAPI・フロントエンドhookは実装済みだが、サイドバーUIに削除ボタンが未実装のためスキップ。

- **画面**: /chat/:uuid
- **前提条件**: ログイン済み、既存の会話が存在する
- **操作手順**:
  1. サイドバーの会話一覧で削除ボタンをクリック
  2. 確認ダイアログで削除を確認
- **期待結果**: 会話が削除され、サイドバーから消える

### CHAT-004: 会話一覧の表示

- **画面**: /chat
- **前提条件**: ログイン済み、複数の会話が存在する
- **操作手順**:
  1. /chat にアクセス
- **期待結果**: サイドバーに会話一覧が表示される（更新日時の降順）

---

## SETTINGS: 設定

### SETTINGS-001: プロフィール更新

- **画面**: /settings
- **前提条件**: ログイン済み
- **操作手順**:
  1. /settings にアクセス
  2. 名前フィールドを変更
  3. 保存ボタンをクリック
- **期待結果**: 成功メッセージが表示され、名前が更新される

### SETTINGS-002: パスワード変更成功

- **画面**: /settings
- **前提条件**: ログイン済み
- **操作手順**:
  1. /settings にアクセス
  2. 現在のパスワードを入力
  3. 新しいパスワードを入力
  4. 新しいパスワード（確認）を入力
  5. 変更ボタンをクリック
- **期待結果**: 成功メッセージが表示される

### SETTINGS-003: パスワード変更失敗（現在のパスワードが不正）

- **画面**: /settings
- **前提条件**: ログイン済み
- **操作手順**:
  1. /settings にアクセス
  2. 間違った現在のパスワードを入力
  3. 新しいパスワードを入力
  4. 変更ボタンをクリック
- **期待結果**: エラーメッセージが表示される

### SETTINGS-004: 送信ショートカットキー設定の変更

- **画面**: /settings
- **前提条件**: ログイン済み
- **操作手順**:
  1. /settings にアクセス
  2. 「チャット設定」セクションの「メッセージ送信キー」を確認（デフォルト: Enter）
  3. 「Ctrl+Enter」（macOS: 「Cmd+Enter」）のラジオボタンを選択
- **期待結果**: 設定が即時保存され、成功メッセージ「チャット設定を更新しました」が表示される。チャット画面に遷移するとヒントテキストが変更後の設定を反映している

---

## ADMIN-USER: ユーザー管理

### ADMIN-USER-001: ユーザー一覧の表示

- **画面**: /admin/users
- **前提条件**: 管理者でログイン済み
- **操作手順**:
  1. /admin/users にアクセス
- **期待結果**: ユーザー一覧テーブルが表示される（メール、ロール、作成日時）

### ADMIN-USER-002: ユーザーの作成

- **画面**: /admin/users
- **前提条件**: 管理者でログイン済み
- **操作手順**:
  1. /admin/users にアクセス
  2. 「+ 新規ユーザー追加」ボタンをクリック
  3. メールアドレスを入力し、ロールを選択
  4. 作成ボタンをクリック
- **期待結果**: ユーザーが作成され、初期パスワードがモーダルで表示される。一覧に新しいユーザーが追加される

### ADMIN-USER-003: ユーザーの削除

- **画面**: /admin/users
- **前提条件**: 管理者でログイン済み、削除対象のユーザーが存在する
- **操作手順**:
  1. /admin/users にアクセス
  2. 対象ユーザーの削除ボタンをクリック
  3. 確認ダイアログで削除を確認
- **期待結果**: ユーザーが削除され、一覧から消える

---

## ADMIN-DASH: ダッシュボード

### ADMIN-DASH-001: ダッシュボード表示

- **画面**: /admin/dashboard
- **前提条件**: 管理者でログイン済み
- **操作手順**:
  1. /admin/dashboard にアクセス
- **期待結果**: サマリーカード（ユーザー数、会話数、トークン数、コスト）、トレンドチャート、ランキングテーブルが表示される

### ADMIN-DASH-002: 期間フィルターの変更

- **画面**: /admin/dashboard
- **前提条件**: 管理者でログイン済み
- **操作手順**:
  1. /admin/dashboard にアクセス
  2. 期間フィルターを「30日間」に変更
- **期待結果**: トレンドチャートとランキングが30日間のデータに更新される

---

## ADMIN-CONV: 会話履歴

### ADMIN-CONV-001: 会話履歴一覧の表示

- **画面**: /admin/conversations
- **前提条件**: 管理者でログイン済み
- **操作手順**:
  1. /admin/conversations にアクセス
- **期待結果**: 全ユーザーの会話一覧が表示される（ユーザー名、タイトル、メッセージ数、日時）

### ADMIN-CONV-002: 会話詳細の閲覧

- **画面**: /admin/conversations
- **前提条件**: 管理者でログイン済み、会話が存在する
- **操作手順**:
  1. /admin/conversations にアクセス
  2. 任意の会話をクリック
- **期待結果**: 会話詳細モーダルが開き、全メッセージが表示される
