---
name: context-engineering
description: Claude Codeプロジェクトのコンテキスト設計・構築・リファクタリングを行うスキル。CLAUDE.md、サブエージェント、スキル、スラッシュコマンド、ドキュメントの5層構造に基づいてプロジェクトのコンテキストを設計・整備する。新規プロジェクトのコンテキスト初期設計、既存プロジェクトのコンテキスト改善、CLAUDE.mdの作成・レビュー、サブエージェントやスキルの設計、スラッシュコマンドの定義、設計ドキュメントの整備などに使用する。「コンテキスト設計」「CLAUDE.md」「エージェント設計」「スキル設計」「スラッシュコマンド作成」「プロジェクト構造の整理」「ドキュメント整備」といったキーワードが出たら必ずこのスキルを使うこと。
---

# Claude Codeコンテキストエンジニアリング

## このスキルの目的

Claude Codeプロジェクトにおいて、AIが効率的かつ一貫性を持って開発を行うためのコンテキスト構造を設計・構築する。

コンテキストの質がAIの出力品質を直接決める。このスキルは、プロジェクト固有の情報を5つの層に分離・配置し、各層が適切に連携する構造を作ることで、Claude Codeの能力を最大限に引き出す。

## 3つの設計原則

すべての設計判断はこの3原則に基づく。優先順位もこの順とする。

1. **DRY原則** — 同じ情報を複数の場所に書かない。1つの層にのみ定義し、他からは参照でアクセスする。
2. **最小コンテキスト原則** — 必要なコンテキストだけを、必要なときにロードする。全情報を常にロードしない。
3. **疎結合原則** — スラッシュコマンド・スキル・エージェントは互いに独立して定義・変更可能にする。特定の組み合わせに依存させない。

## 5層コンテキストモデル

```
┌─────────────────────────────────────────────────┐
│                   CLAUDE.md                      │
│            （全層から常に参照される）                │
└─────────────────────┬───────────────────────────┘
                      │ 参照
                      ▼
┌─────────────────────────────────────────────────┐
│              スラッシュコマンド                     │
│          （タスクのオーケストレーション）              │
└──────┬──────────────────────────────┬────────────┘
       │ 呼び出し                      │ 呼び出し
       ▼                              ▼
┌──────────────────┐          ┌──────────────────┐
│  サブエージェント   │──使用──▶│     スキル        │
│ （役割・判断主体）  │          │（共有される能力）   │
└──────┬───────────┘          └──────────────────┘
       │ 参照
       ▼
┌──────────────────┐
│   ドキュメント     │
│（コード探索の地図） │
└──────────────────┘
```

各層の詳細は `references/layers.md` を参照すること。

## 層間の関係ルール

| 起点 | 関係 | 終点 | 説明 |
|------|------|------|------|
| 全層 | 参照 | CLAUDE.md | すべてのコンテキストはCLAUDE.mdを前提とする |
| スラッシュコマンド | 呼び出し | サブエージェント | タスク実行のためにエージェントを起動 |
| スラッシュコマンド | 呼び出し | スキル | 場合によりスキルを直接呼び出す |
| サブエージェント | 使用 | スキル | 役割に応じてスキルを名指しで使用 |
| サブエージェント | 参照 | ドキュメント | 役割に応じてドキュメントを参照 |
| スキル | 参照しない | ドキュメント | スキルからドキュメントへの直接参照は禁止。ドキュメント参照は常にエージェント経由 |

## ワークフロー

### モード1: 新規プロジェクトのコンテキスト設計

プロジェクトの情報をヒアリングし、5層すべてを初期設計する。

**手順:**

1. ヒアリング — プロジェクトの目的、技術スタック、チーム構成、主要機能を確認する
2. CLAUDE.mdの作成 — `references/claude-md-guide.md` に従って作成する
3. ドキュメント層の設計 — 必要なドキュメント一覧を定義する（`references/documents-guide.md`）
4. サブエージェントの設計 — 役割ごとのエージェントを定義する（`references/layers.md` の「サブエージェント」節）
5. スキルの設計 — 再利用可能な技術的能力を定義する（`references/layers.md` の「スキル」節）
6. スラッシュコマンドの設計 — 定型タスクのオーケストレーターを定義する（`references/layers.md` の「スラッシュコマンド」節）
7. ディレクトリ構造の出力 — 設計結果をファイルとして出力する

### モード2: 既存プロジェクトのコンテキスト改善

既存のCLAUDE.mdやコンテキスト構造を3原則に基づいてレビュー・改善する。

**手順:**

1. 現状把握 — 既存のCLAUDE.md、エージェント定義、スキル定義を読み込む
2. 診断 — `references/diagnosis-checklist.md` のチェックリストで問題を特定する
3. 改善提案 — 3原則に基づいた具体的な改善案を提示する
4. 実装 — ユーザーの承認後、ファイルを修正する

### モード3: 個別層の作成・編集

特定の層（CLAUDE.md、エージェント、スキル、スラッシュコマンド、ドキュメント）だけを作成・編集する。

該当する層のリファレンスを読み、そのガイドに従って作成・編集する。

## リファレンス一覧

| ファイル | 内容 | 読むタイミング |
|---------|------|---------------|
| `references/layers.md` | 5層それぞれの詳細定義・設計指針 | 各層の設計・作成時 |
| `references/claude-md-guide.md` | CLAUDE.mdの書き方テンプレートと判断基準 | CLAUDE.mdの作成・レビュー時 |
| `references/documents-guide.md` | ドキュメント層の設計指針と各ドキュメントの仕様 | ドキュメント整備時 |
| `references/diagnosis-checklist.md` | コンテキスト構造の診断チェックリスト | 既存構造のレビュー時 |
